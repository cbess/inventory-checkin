{% extends "base.tpl" %}

{% block header %}
<script src="/static/js/inventory.js"></script>
{% endblock %}

{% block top_banner %}
{# remove the menu #}
{% endblock %}

{% block content %}
<div id="inventory">
    {% if user.is_authenticated() %}
    <div class="alert alert-info">
        Updated!
    </div>

    <table id="items">
    {% for item in items %}
        <tr id="item-{{ item.id }}">
            <td class="device-name">
                {{ item.name }}
            </td>
            <td class="person">
                <select class="person-list" {% if item.status == 1 %}DISABLED{% endif %}>
                    <option value="0">Available</option>
                {% for person in persons %}
                    {% set selected = '' %}
                    {% if item.status == 1 %}
                        {# only if it is checked out do we grab the latest person #}
                        {% if item.get_latest_person().id == person.id %}{% set selected = 'SELECTED' %}{% endif %}
                    {% endif %}
                    <option value="{{ person.id }}" {{ selected }}>{{ person.name }}</option>
                {% endfor %}
                </select>
            </td>
            <td class="action">
                <input type="checkbox" class="checkbox" value="{{ item.id }}" {% if item.status == 1 %}CHECKED{% endif %} />
            </td>
        </tr>
    {% else %}
        No inventory items.
    {% endfor %}
    </table>

    {% else %}
    <a href="{{ url_for('login_view') }}" class="btn btn-inverse">Login</a>
    {% endif %}
</div>
{% endblock %}